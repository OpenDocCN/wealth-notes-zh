![](img/616b4a248eeb9a5f91be4174c5c9f2fe_0.png)

# 课程名称：商业分析 - 第41课：使用求解器进行优化 🧮

![](img/616b4a248eeb9a5f91be4174c5c9f2fe_2.png)

在本节课中，我们将学习如何将代数优化模型转化为电子表格模型，并使用Excel的求解器工具来找到最优决策。我们将以Zooter公司的滑板车生产计划为例，详细讲解决策变量、目标函数和约束条件的设置过程。

---

## 概述

上一节我们介绍了Zooter公司的资源分配问题，并建立了代数优化模型。本节中，我们将把这个代数模型转化为电子表格模型，并使用Excel的求解器工具来寻找最优的生产计划。

---

## 1. 准备工作：定位求解器工具

在开始建模之前，我们需要确保Excel中已启用“求解器”加载项。

以下是定位和启用求解器的步骤：

*   在Excel 2013及以上版本中，求解器通常位于“数据”选项卡下的“分析”组中。
*   如果未看到“求解器”按钮，请转到“文件”->“选项”->“加载项”。在底部“管理”下拉菜单中选择“Excel加载项”，点击“转到…”，勾选“求解器加载项”并点击“确定”。
*   对于Mac版Excel或Google Sheets，操作步骤可能略有不同，但核心功能一致。

---

## 2. 在电子表格中建立优化模型

我们需要在电子表格中定义优化模型的三个核心组件：决策变量、目标函数和约束条件。

### 2.1 定义决策变量

决策变量代表我们可控制的未知数。在Zooter问题中，即两种滑板车的生产数量。

*   选择单元格`C10`存放要生产的Razor滑板车数量（决策变量 `r`）。
*   选择单元格`D10`存放要生产的Navajo滑板车数量（决策变量 `n`）。
*   为便于识别，建议用蓝色粗体边框突出显示这些决策变量单元格。

### 2.2 定义目标函数

目标函数是我们希望最大化或最小化的量。在本例中，是总利润。

*   选择单元格`F10`存放总利润值。
*   总利润的计算公式为：`=150*C10 + 160*D10`。
*   对于变量较多的情况，推荐使用`SUMPRODUCT`函数，公式可简写为：`=SUMPRODUCT(C9:D9, C10:D10)`。其中`C9:D9`区域存放单位利润（150和160），`C10:D10`是决策变量。
*   为便于识别，建议用红色粗体边框突出显示目标函数单元格。

### 2.3 定义约束条件

约束条件限制了决策变量的可选范围。Zooter问题涉及三种资源限制：车架制造、车轮与甲板组装、质检与包装的时间。

我们需要计算任意生产计划下各种资源的消耗量，并确保其不超过可用量。

以下是计算资源消耗的步骤：

1.  **计算资源消耗**：在单元格`E14`中，输入公式计算车架制造时间消耗：`=SUMPRODUCT($C$10:$D$10, C14:D14)`。这里`$C$10:$D$10`是**绝对引用**的决策变量，`C14:D14`是该资源每单位产品的消耗量。
2.  **复制公式**：将`E14`中的公式复制到`E15`和`E16`，即可快速得到另外两种资源的消耗量。绝对引用确保了复制公式时决策变量的位置不变。
3.  **设定约束关系**：资源消耗量（`E14:E16`）必须小于等于资源可用量（`G14:G16`）。

---

## 3. 使用求解器进行优化

模型建立完毕后，即可使用求解器寻找最优解。

以下是配置求解器的步骤：

1.  打开“数据”选项卡下的“求解器”对话框。
2.  **设置目标**：选择目标函数单元格`$F$10`，并选择“最大值”。
3.  **设置可变单元格**：选择决策变量单元格`$C$10:$D$10`。
4.  **添加约束**：
    *   点击“添加”，设置资源约束：`$E$14:$E$16 <= $G$14:$G$16`。
    *   再次点击“添加”，设置整数约束：`$C$10:$D$10` 为 `int`（整数）。
    *   勾选“使无约束变量为非负数”选项，确保产量不为负。
5.  **选择求解方法**：对于此类线性问题，可选择“单纯线性规划”。为通用起见，也可保留默认的“非线性GRG”方法。
6.  点击“求解”。

求解器将计算并给出最优生产计划：生产840辆Razor滑板车和450辆Navajo滑板车，最大利润为**198,000美元**。

---

## 4. 理解求解器信息

运行求解器后，需正确解读其提示信息：

*   **“规划求解找到一解。”**：这是期望的结果，表示找到了最优解。
*   **“目标单元格的值不收敛。”**：这通常意味着模型缺少关键约束，导致目标值可以无限增大（如未设置资源上限）。
*   **“规划求解找不到有用的解。”**：这表示约束条件之间存在矛盾，没有同时满足所有约束的可行解（如要求的资源既不能超过A，又不能少于B，而A<B）。

---

## 核心概念总结

*   **解**：决策变量的一组特定取值。
*   **可行解**：满足所有约束条件的解。
*   **不可行解**：违反至少一个约束条件的解。
*   **目标函数值**：将某个解代入目标函数后计算得到的数值。
*   **最优解**：所有可行解中，使目标函数值达到最佳（最大或最小）的那个解。有时可能存在多个最优解。

![](img/616b4a248eeb9a5f91be4174c5c9f2fe_4.png)

---

## 总结

本节课中，我们一起学习了如何利用Excel求解器解决优化问题。我们完成了从代数模型到电子表格模型的转换，详细设置了决策变量、目标函数和约束条件，并成功运行求解器得到了Zooter问题的最优生产计划。我们掌握的两个关键电子表格技巧是：使用`SUMPRODUCT`函数简化计算，以及使用**绝对引用**（`$`）来高效复制公式。这些是构建更复杂优化模型的基础。Zooter问题是一个典型的资源分配案例，在后续课程中，我们将探讨其他类型的优化问题，例如网络配送问题。